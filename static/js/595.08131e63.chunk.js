(self.webpackChunkflighttools=self.webpackChunkflighttools||[]).push([[595],{180:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteDB:()=>m,openDB:()=>v,unwrap:()=>p,wrap:()=>f});const s=(e,t)=>t.some((t=>e instanceof t));let r,o;const i=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||l.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e.apply(p(this),n),f(i.get(this))}:function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return f(e.apply(p(this),n))}:function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];const o=e.call(p(this),t,...s);return l.set(o,t.sort?t.sort():[t]),f(o)}}function g(e){return"function"===typeof e?h(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const s=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",o),e.removeEventListener("abort",o)},r=()=>{t(),s()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),s()};e.addEventListener("complete",r),e.addEventListener("error",o),e.addEventListener("abort",o)}));a.set(e,t)}(e),s(e,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const s=()=>{e.removeEventListener("success",r),e.removeEventListener("error",o)},r=()=>{t(f(e.result)),s()},o=()=>{n(e.error),s()};e.addEventListener("success",r),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&i.set(t,e)})).catch((()=>{})),u.set(t,e),t}(e);if(c.has(e))return c.get(e);const t=g(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const p=e=>u.get(e);function v(e,t){let{blocked:n,upgrade:s,blocking:r,terminated:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),a=f(i);return s&&i.addEventListener("upgradeneeded",(e=>{s(f(i.result),e.oldVersion,e.newVersion,f(i.transaction),e)})),n&&i.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function m(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),f(n).then((()=>{}))}const y=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function x(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),s=t!==n,r=b.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!r&&!y.includes(n))return;const o=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let o=t.store;for(var i=arguments.length,a=new Array(i>1?i-1:0),l=1;l<i;l++)a[l-1]=arguments[l];return s&&(o=o.index(a.shift())),(await Promise.all([o[n](...a),r&&t.done]))[0]};return w.set(t,o),o}d=(e=>({...e,get:(t,n,s)=>x(t,n)||e.get(t,n,s),has:(t,n)=>!!x(t,n)||e.has(t,n)}))(d)},572:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var s=n(43),r=n(368),o=n(228),i=n.n(o),a=(n(433),n(761),n(809)),l=n(579);delete i().Icon.Default.prototype._getIconUrl,i().Icon.Default.mergeOptions({iconRetinaUrl:n(249),iconUrl:n(24),shadowUrl:n(71)});const c=()=>{var e,t;const{isDarkMode:n}=(0,r.D)(),[o,c]=(0,s.useState)({latitude:null,longitude:null,altitude:null,speed:null,heading:null,lastUpdate:new Date,gpsAccuracy:null}),[u,d]=(0,s.useState)(null),[h,g]=(0,s.useState)(!0),f=(0,s.useRef)(null),p=(0,s.useRef)(null),v=(0,s.useRef)(null),m=(0,s.useRef)(null),y=(0,s.useRef)(null),b=(0,s.useRef)(null);return(0,s.useEffect)((()=>{if(!f.current){f.current=i().map("map").setView([0,0],2);const e=i().tileLayer.offline("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xa9 OpenStreetMap contributors",subdomains:"abc",minZoom:0,maxZoom:5}).addTo(f.current);b.current=e,(async()=>{if(!f.current)return;const e=b.current;if(!e)return;const t=i().tileLayer.offline("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xa9 OpenStreetMap contributors",subdomains:"abc",minZoom:0,maxZoom:5});t.addTo(f.current),e&&f.current.removeLayer(e),b.current=t;const n=f.current.getBounds(),s=t.getTileUrls(n,5);try{await t.preCache(s),console.log("Tiles pre-cached successfully")}catch(r){console.error("Error pre-caching tiles:",r)}})()}if(!navigator.geolocation)return g(!1),void d("GPS is not available on this device");return(async()=>{try{m.current=navigator.geolocation.watchPosition((e=>{y.current=e;const t={latitude:e.coords.latitude,longitude:e.coords.longitude,altitude:e.coords.altitude,speed:e.coords.speed,heading:e.coords.heading,lastUpdate:new Date,gpsAccuracy:e.coords.accuracy};if(c(t),d(null),f.current&&t.latitude&&t.longitude){const e=i().latLng(t.latitude,t.longitude);p.current?(p.current.setLatLng(e),p.current.setIcon(i().divIcon({html:`<div style="transform: rotate(${t.heading||0}deg)">\n                    <img src="${a.A}" alt="plane" style="width: 24px; height: 24px;" />\n                  </div>`,className:"",iconSize:[24,24],iconAnchor:[12,12]}))):p.current=i().marker(e,{icon:i().divIcon({html:`<div style="transform: rotate(${t.heading||0}deg)">\n                      <img src="${a.A}" alt="plane" style="width: 24px; height: 24px;" />\n                    </div>`,className:"",iconSize:[24,24],iconAnchor:[12,12]})}).addTo(f.current),v.current?(v.current.setLatLng(e),v.current.setRadius(t.gpsAccuracy||0)):v.current=i().circle(e,{radius:t.gpsAccuracy||0,color:n?"#60a5fa":"#3b82f6",fillColor:n?"#60a5fa":"#3b82f6",fillOpacity:.2,weight:1}).addTo(f.current),f.current.setView(e,f.current.getZoom())}}),(e=>{if(console.warn("GPS Error:",e),d(`GPS Error: ${e.message}`),y.current){const e={latitude:y.current.coords.latitude,longitude:y.current.coords.longitude,altitude:y.current.coords.altitude,speed:y.current.coords.speed,heading:y.current.coords.heading,lastUpdate:new Date,gpsAccuracy:y.current.coords.accuracy};if(c(e),f.current&&e.latitude&&e.longitude){const t=i().latLng(e.latitude,e.longitude);p.current&&(p.current.setLatLng(t),p.current.setIcon(i().divIcon({html:`<div style="transform: rotate(${e.heading||0}deg)">\n                      <img src="${a.A}" alt="plane" style="width: 24px; height: 24px;" />\n                    </div>`,className:"",iconSize:[24,24],iconAnchor:[12,12]}))),v.current&&(v.current.setLatLng(t),v.current.setRadius(e.gpsAccuracy||0))}}}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}catch(e){d("Failed to start GPS tracking"),console.error("GPS Error:",e)}})(),()=>{null!==m.current&&navigator.geolocation.clearWatch(m.current),f.current&&(f.current.remove(),f.current=null)}}),[n]),(0,l.jsxs)("div",{className:"p-4 "+(n?"text-white":"text-gray-800"),children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"In-Flight Tracker"}),!h&&(0,l.jsx)("div",{className:"p-4 rounded-lg mb-4 "+(n?"bg-red-900 text-red-200":"bg-red-100 text-red-800"),children:"GPS is not available on this device. This tool requires GPS functionality to work."}),u&&(0,l.jsx)("div",{className:"p-4 rounded-lg mb-4 "+(n?"bg-yellow-900 text-yellow-200":"bg-yellow-100 text-yellow-800"),children:u}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,l.jsxs)("div",{className:`p-4 rounded-lg ${n?"bg-gray-800":"bg-white"} shadow`,children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Current Position"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("p",{children:["Latitude: ",(null===(e=o.latitude)||void 0===e?void 0:e.toFixed(6))||"N/A"]}),(0,l.jsxs)("p",{children:["Longitude: ",(null===(t=o.longitude)||void 0===t?void 0:t.toFixed(6))||"N/A"]}),(0,l.jsxs)("p",{children:["Altitude: ",o.altitude?`${Math.round(o.altitude)}m`:"N/A"]}),(0,l.jsxs)("p",{children:["Speed: ",o.speed?`${x=Math.round(3.6*o.speed),Math.round(.539957*x)} knots`:"N/A"]}),(0,l.jsxs)("p",{children:["Heading: ",o.heading?`${Math.round(o.heading)}\xb0`:"N/A"]}),(0,l.jsxs)("p",{children:["GPS Accuracy: ",o.gpsAccuracy?`\xb1${w=Math.round(o.gpsAccuracy),Math.round(3.28084*w)}ft`:"N/A"]}),(0,l.jsxs)("p",{children:["Last Update: ",o.lastUpdate.toLocaleTimeString()]})]})]}),(0,l.jsxs)("div",{className:`p-4 rounded-lg ${n?"bg-gray-800":"bg-white"} shadow`,children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Map View"}),(0,l.jsx)("div",{id:"map",className:"w-full h-64 rounded-lg"})]})]})]});var w,x}},761:function(e,t,n){!function(e,t,n){"use strict";function s(e,t,n,s){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function i(e){try{l(s.next(e))}catch(t){o(t)}}function a(e){try{l(s.throw(e))}catch(t){o(t)}}function l(e){e.done?n(e.value):r(e.value).then(i,a)}l((s=s.apply(e,t||[])).next())}))}const r="tileStore",o="urlTemplate";let i;function a(){return i||(i=n.openDB("leaflet.offline",2,{upgrade(e,t){if(n.deleteDB("leaflet_offline"),n.deleteDB("leaflet_offline_areas"),t<1){const t=e.createObjectStore(r,{keyPath:"key"});t.createIndex(o,"urlTemplate"),t.createIndex("z","z")}}}),i)}function l(){return s(this,void 0,void 0,(function*(){return(yield a()).count(r)}))}function c(e){return s(this,void 0,void 0,(function*(){const t=IDBKeyRange.only(e);return(yield a()).getAllFromIndex(r,o,t)}))}function u(e){return s(this,void 0,void 0,(function*(){const t=yield fetch(e);if(!t.ok)throw new Error(`Request failed with status ${t.statusText}`);return t.blob()}))}function d(e,t){return s(this,void 0,void 0,(function*(){return(yield a()).put(r,Object.assign({blob:t},e))}))}function h(e,n){return t.Util.template(e,Object.assign(Object.assign({},n),{r:t.Browser.retina?"@2x":""}))}function g(e,n){const s=[];if(!e.min||!e.max)return s;const r=e.min.divideBy(n.x).floor(),o=e.max.divideBy(n.x).floor();for(let i=r.y;i<=o.y;i+=1)for(let e=r.x;e<=o.x;e+=1)s.push(new t.Point(e,i));return s}function f(e,n){const s={type:"FeatureCollection",features:[]};for(let r=0;r<n.length;r+=1){const o=new t.Point(n[r].x*e.x,n[r].y*e.y),i=new t.Point(o.x+e.x,o.y+e.y),a=t.CRS.EPSG3857.pointToLatLng(o,n[r].z),l=t.CRS.EPSG3857.pointToLatLng(i,n[r].z);s.features.push({type:"Feature",properties:n[r],geometry:{type:"Polygon",coordinates:[[[a.lng,a.lat],[l.lng,a.lat],[l.lng,l.lat],[a.lng,l.lat],[a.lng,a.lat]]]}})}return s}function p(e){return s(this,void 0,void 0,(function*(){return(yield a()).delete(r,e)}))}function v(e){return s(this,void 0,void 0,(function*(){return(yield a()).get(r,e).then((e=>e&&e.blob))}))}function m(e){return s(this,void 0,void 0,(function*(){const t=yield a();return void 0!==(yield t.getKey(r,e))}))}function y(){return s(this,void 0,void 0,(function*(){return(yield a()).clear(r)}))}function b(e,t){return s(this,void 0,void 0,(function*(){if(!(yield m(e)))return t;const n=yield v(e);return URL.createObjectURL(n)}))}class w extends t.TileLayer{createTile(e,n){const s=document.createElement("img");return t.DomEvent.on(s,"load",t.Util.bind(this._tileOnLoad,this,n,s)),t.DomEvent.on(s,"error",t.Util.bind(this._tileOnError,this,n,s)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(s.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),s.alt="",s.setAttribute("role","presentation"),b(this._getStorageKey(e),this.getTileUrl(e)).then((e=>s.src=e)),s}_getStorageKey(e){return h(this._url,Object.assign(Object.assign(Object.assign({},e),this.options),{s:this.options.subdomains[0]}))}getTileUrls(e,t){var n;const s=[],r=g(e,this.getTileSize());for(let o=0;o<r.length;o+=1){const e=r[o],i=Object.assign(Object.assign({},this.options),{x:e.x,y:e.y,z:t+(this.options.zoomOffset||0)});s.push({key:h(this._url,Object.assign(Object.assign({},i),{s:null===(n=this.options.subdomains)||void 0===n?void 0:n[0]})),url:h(this._url,Object.assign(Object.assign({},i),{s:this._getSubdomain(e)})),z:t,x:e.x,y:e.y,urlTemplate:this._url,createdAt:Date.now()})}return s}}function x(e,t){return new w(e,t)}window.L&&(window.L.tileLayer.offline=x);class L extends t.Control{constructor(e,t){super(t),this.status={storagesize:0,lengthToBeSaved:0,lengthSaved:0,lengthLoaded:0,_tilesforSave:[]},this._baseLayer=e,this.setStorageSize(),this.options=Object.assign({position:"topleft",saveText:"+",rmText:"-",maxZoom:19,saveWhatYouSee:!1,bounds:null,confirm:null,confirmRemoval:null,parallel:50,zoomlevels:void 0,alwaysDownload:!0},t)}setStorageSize(){return this.status.storagesize?Promise.resolve(this.status.storagesize):l().then((e=>(this.status.storagesize=e,this._baseLayer.fire("storagesize",this.status),e))).catch((()=>0))}getStorageSize(e){this.setStorageSize().then((t=>{e&&e(t)}))}setLayer(e){this._baseLayer=e}onAdd(){const e=t.DomUtil.create("div","savetiles leaflet-bar"),{options:n}=this;return this._createButton(n.saveText,"savetiles",e,this._saveTiles),this._createButton(n.rmText,"rmtiles",e,this._rmTiles),e}_createButton(e,n,s,r){const o=t.DomUtil.create("a",n,s);return o.innerHTML=e,o.href="#",o.ariaRoleDescription="button",t.DomEvent.on(o,"mousedown dblclick",t.DomEvent.stopPropagation).on(o,"click",t.DomEvent.stop).on(o,"click",r,this).on(o,"click",this._refocusOnMap,this),o}_saveTiles(){const e=this._calculateTiles();this._resetStatus(e);const t=()=>s(this,void 0,void 0,(function*(){this._baseLayer.fire("savestart",this.status);const t=()=>s(this,void 0,void 0,(function*(){const n=e.shift();if(void 0===n)return Promise.resolve();const s=yield this._loadTile(n);return s&&(yield this._saveTile(n,s)),t()})),n=Math.min(e.length,this.options.parallel);for(let e=0;e<n;e+=1)t()}));this.options.confirm?this.options.confirm(this.status,t):t()}_calculateTiles(){let e=[];const n=5;let s=[];if(this.options.saveWhatYouSee){const e=this._map.getZoom();if(e<n)throw new Error(`It's not possible to save with zoom below level ${n}.`);const{maxZoom:t}=this.options;for(let n=e;n<=t;n+=1)s.push(n)}else s=this.options.zoomlevels||[this._map.getZoom()];const r=this.options.bounds||this._map.getBounds();for(let o=0;o<s.length;o+=1){const n=t.bounds(this._map.project(r.getNorthWest(),s[o]),this._map.project(r.getSouthEast(),s[o]));e=e.concat(this._baseLayer.getTileUrls(n,s[o]))}return e}_resetStatus(e){this.status={lengthLoaded:0,lengthToBeSaved:e.length,lengthSaved:0,_tilesforSave:e,storagesize:this.status.storagesize}}_loadTile(e){return s(this,void 0,void 0,(function*(){let t;return!0!==this.options.alwaysDownload&&!1!==(yield m(e.key))||(t=yield u(e.url),this.status.lengthLoaded+=1),this.status.lengthLoaded+=1,this._baseLayer.fire("loadtileend",this.status),this.status.lengthLoaded===this.status.lengthToBeSaved&&this._baseLayer.fire("loadend",this.status),t}))}_saveTile(e,t){return s(this,void 0,void 0,(function*(){yield d(e,t),this.status.lengthSaved+=1,this._baseLayer.fire("savetileend",this.status),this.status.lengthSaved===this.status.lengthToBeSaved&&(this._baseLayer.fire("saveend",this.status),this.setStorageSize())}))}_rmTiles(){const e=()=>{y().then((()=>{this.status.storagesize=0,this._baseLayer.fire("tilesremoved"),this._baseLayer.fire("storagesize",this.status)}))};this.options.confirmRemoval?this.options.confirmRemoval(this.status,e):e()}}function S(e,t){return new L(e,t)}window.L&&(window.L.control.savetiles=S),e.downloadTile=u,e.getBlobByKey=v,e.getStorageInfo=c,e.getStorageLength=l,e.getStoredTilesAsJson=f,e.getTileImageSource=b,e.getTilePoints=g,e.getTileUrl=h,e.hasTile=m,e.removeTile=p,e.saveTile=d,e.savetiles=S,e.tileLayerOffline=x,e.truncate=y}(t,n(228),n(180))},809:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});n(43);const s=n.p+"static/media/plane-icon.5312c99550d9e701054eea554971757c.svg"}}]);
//# sourceMappingURL=595.08131e63.chunk.js.map