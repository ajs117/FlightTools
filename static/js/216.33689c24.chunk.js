"use strict";(self.webpackChunkflighttools=self.webpackChunkflighttools||[]).push([[216],{23:(e,t,n)=>{n.d(t,{e:()=>s});var a=n(215),l=n(996),r=n(576);var i=n(228);const s=(0,a.X3)((function(e,t){let{url:n,...a}=e;const s=new i.TileLayer(n,(0,l.P)(a,t));return(0,r.Q)(s,t)}),(function(e,t,n){!function(e,t,n){const{opacity:a,zIndex:l}=t;null!=a&&a!==n.opacity&&e.setOpacity(a),null!=l&&l!==n.zIndex&&e.setZIndex(l)}(e,t,n);const{url:a}=t;null!=a&&a!==n.url&&e.setUrl(a)}))},36:(e,t,n)=>{n.d(t,{p:()=>s});var a=n(215),l=n(576),r=n(772),i=n(228);const s=(0,a.Nq)((function(e,t){let{position:n,...a}=e;const s=new i.Marker(n,a);return(0,l.Q)(s,(0,r.W4)(t,{overlayContainer:s}))}),(function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}))},167:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var a=n(43),l=n(515),r=n(419),i=n(23),s=n(36),o=(n(433),n(228)),c=n.n(o),u=n(809),d=n(368),f=n(579);delete c().Icon.Default.prototype._getIconUrl,c().Icon.Default.mergeOptions({iconRetinaUrl:n(249),iconUrl:n(24),shadowUrl:n(71)});const g=(e,t,n)=>{var a;const l=Date.now(),r=t*((l-(null!==(a=e.timestamp)&&void 0!==a?a:l))/1e3)/3600,i=n*Math.PI/180,s=e.lat*Math.PI/180,o=e.lng*Math.PI/180,c=r/6371,u=Math.asin(Math.sin(s)*Math.cos(c)+Math.cos(s)*Math.sin(c)*Math.cos(i)),d=o+Math.atan2(Math.sin(i)*Math.sin(c)*Math.cos(s),Math.cos(c)-Math.sin(s)*Math.sin(u));return{lat:180*u/Math.PI,lng:180*d/Math.PI,timestamp:l,name:e.name}},h=(e,t,n,a)=>{const l=e*Math.PI/180,r=n*Math.PI/180,i=(n-e)*Math.PI/180,s=(a-t)*Math.PI/180,o=Math.sin(i/2)*Math.sin(i/2)+Math.cos(l)*Math.cos(r)*Math.sin(s/2)*Math.sin(s/2),c=2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o));return Math.round(6371e3*c)},m=e=>{let{center:t}=e;const n=(0,l.ko)();return(0,a.useEffect)((()=>{n.setView(t,n.getZoom())}),[t,n]),null},p=()=>{var e,t;const{isDarkMode:n}=(0,d.D)(),[l,o]=(0,a.useState)((()=>{const e=localStorage.getItem("lastLocation");return e?JSON.parse(e):null})),[p,v]=(0,a.useState)(null),[x,b]=(0,a.useState)(null),[w,y]=(0,a.useState)(null),[I,N]=(0,a.useState)(""),[S,j]=(0,a.useState)(""),[M,E]=(0,a.useState)(!1),[k,C]=(0,a.useState)(""),[$,O]=(0,a.useState)((()=>{const e=localStorage.getItem("cachedFlightData");if(e){const{data:t,timestamp:n,flightNum:a}=JSON.parse(e);if(Date.now()-n<864e5)return C(a),t;localStorage.removeItem("cachedFlightData")}return null})),[D,P]=(0,a.useState)((()=>{const e=localStorage.getItem("cachedPosition");return e?JSON.parse(e):null})),[z,L]=(0,a.useState)(null),[R,U]=(0,a.useState)(null),[_,A]=(0,a.useState)(null),[F,J]=(0,a.useState)(null),[T,K]=(0,a.useState)((()=>{const e=localStorage.getItem("cachedLastDrawTime");return e?new Date(JSON.parse(e)):null})),[q,H]=(0,a.useState)((()=>{const e=localStorage.getItem("cachedFlightData");if(e){const{timestamp:t}=JSON.parse(e);return t}return null})),[W,B]=(0,a.useState)(null),[Z,Q]=(0,a.useState)(null);(0,a.useEffect)((()=>{l?localStorage.setItem("lastLocation",JSON.stringify(l)):localStorage.removeItem("lastLocation")}),[l]),(0,a.useEffect)((()=>{if($&&k){const e=Date.now();H(e),localStorage.setItem("cachedFlightData",JSON.stringify({data:$,timestamp:e,flightNum:k}))}else H(null),localStorage.removeItem("cachedFlightData")}),[$,k]),(0,a.useEffect)((()=>{D?localStorage.setItem("cachedPosition",JSON.stringify(D)):localStorage.removeItem("cachedPosition")}),[D]),(0,a.useEffect)((()=>{T?localStorage.setItem("cachedLastDrawTime",JSON.stringify(T.toISOString())):localStorage.removeItem("cachedLastDrawTime")}),[T]),(0,a.useEffect)((()=>()=>{z&&clearInterval(z),R&&clearInterval(R),_&&clearInterval(_),F&&clearInterval(F)}),[z,R,_,F]),(0,a.useEffect)((()=>{if(l&&p){const e=h(l.lat,l.lng,p.lat,p.lng);b(e),y(e),_&&clearInterval(_),F&&clearInterval(F);const t=setInterval((()=>{if(l&&p){const e=h(l.lat,l.lng,p.lat,p.lng);b(e)}}),25);if(A(t),null!==$&&void 0!==$&&$.live&&D){const e=setInterval((()=>{if($.live&&D&&!$.live.is_ground&&$.live.speed_horizontal>=50){const e=g(D,$.live.speed_horizontal,$.live.direction);v({lat:e.lat,lng:e.lng,name:`${$.airline.name} ${$.flight.number}`})}}),100);J(e)}}else b(null),y(null),_&&(clearInterval(_),A(null)),F&&(clearInterval(F),J(null))}),[l,p,$,D,g]),(0,a.useEffect)((()=>{if(null===x||null===w)return void y(x);const e=x-w;if(Math.abs(e)<1)return void y(x);const t=Math.sign(e)*Math.min(Math.abs(e),Math.max(1,Math.abs(e)/5)),n=setTimeout((()=>{y((e=>null!==e?e+t:null))}),16);return()=>clearTimeout(n)}),[x,w]);const V=async()=>{if(S.trim()){E(!0),N("");try{const e=await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(S)}`);if(!e.ok)throw new Error("Failed to fetch location");const t=await e.json();if(0===t.length)return N("Location not found"),void E(!1);const n={lat:parseFloat(t[0].lat),lng:parseFloat(t[0].lon),name:t[0].display_name};o(n),v(null)}catch(e){N("Error searching location: "+(e instanceof Error?e.message:"Unknown error"))}finally{E(!1)}}},X=(0,a.useCallback)((()=>{if(null!==$&&void 0!==$&&$.live&&D){if($.live.is_ground||$.live.speed_horizontal<50)return console.log("Not interpolating - aircraft on ground or speed too low"),void K(new Date);console.log("Calculating new position...");const e=g(D,$.live.speed_horizontal,$.live.direction);console.log(`New position: ${e.lat}, ${e.lng}`),P(e),v({lat:e.lat,lng:e.lng,name:`${$.airline.name} ${$.flight.number}`}),K(new Date)}else console.log("Cannot interpolate - missing flight data or last position")}),[$,D,P,v,K]);(0,a.useEffect)((()=>{if($&&D&&!R){console.log("Initializing interpolation from cached data"),X();const e=setInterval((()=>{console.log("Interpolation interval triggered"),X()}),5e3);U(e)}return()=>{R&&clearInterval(R)}}),[$,D,R,X]);const G=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(k.trim()){E(!0),N("");try{if(!e&&Z){Date.now(),Z.timestamp;if(Z.data.flight.iata===k)return O(Z.data),P({lat:Z.data.live.latitude,lng:Z.data.live.longitude,name:`${Z.data.airline.name} ${Z.data.flight.number}`}),v({lat:Z.data.live.latitude,lng:Z.data.live.longitude,name:`${Z.data.airline.name} ${Z.data.flight.number}`}),void E(!1)}const t=await fetch(`https://api.aviationstack.com/v1/flights?access_key=0568428049f1cef2ccb5aef37792e31f&flight_iata=${k}`);if(!t.ok)throw new Error("Failed to fetch flight data");const n=await t.json();if(!n.data||0===n.data.length)throw new Error("No flight data found");const a=n.data[0];if(!a.live)throw new Error("No live data available for this flight");const l={data:a,timestamp:Date.now()};Q(l),B(l.timestamp),sessionStorage.setItem("lastApiCall",l.timestamp.toString()),O(a),P({lat:a.live.latitude,lng:a.live.longitude,name:`${a.airline.name} ${a.flight.number}`}),v({lat:a.live.latitude,lng:a.live.longitude,name:`${a.airline.name} ${a.flight.number}`})}catch(t){N("Error tracking flight: "+(t instanceof Error?t.message:"Unknown error"))}finally{E(!1)}}else N("Please enter a flight number")};return(0,f.jsx)("div",{className:`min-h-screen ${n?"bg-gray-900":"bg-gray-100"} p-4`,children:(0,f.jsxs)("div",{className:(n?"bg-gray-800":"bg-white")+" rounded-lg shadow p-6 max-w-7xl mx-auto",children:[(0,f.jsxs)("div",{className:"mb-4 space-y-4",children:[(0,f.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,f.jsxs)("div",{className:"flex-1 min-w-[200px] flex gap-2",children:[(0,f.jsx)("input",{type:"text",value:S,onChange:e=>j(e.target.value),onKeyPress:e=>"Enter"===e.key&&V(),hidden:null!==l,placeholder:"Enter location (e.g., London, UK)",className:"flex-1 p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(n?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900")}),(0,f.jsx)("button",{onClick:V,disabled:M||!S.trim(),hidden:null!==l,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-blue-300 whitespace-nowrap",children:"Search"})]}),(0,f.jsxs)("div",{className:"flex-1 min-w-[200px] flex gap-2",children:[(0,f.jsx)("input",{type:"text",value:k,onChange:e=>C(e.target.value.toUpperCase()),onKeyPress:e=>"Enter"===e.key&&G(),placeholder:"Enter flight number (e.g., BA123)",className:"flex-1 p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(n?"bg-gray-700 text-white border-gray-600":"bg-white text-gray-900")}),(0,f.jsx)("button",{onClick:e=>G(),disabled:M||!k.trim(),className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:bg-purple-300 whitespace-nowrap",children:"Track Flight"})]}),(0,f.jsxs)("div",{className:"flex gap-2",children:[l&&(0,f.jsx)("button",{onClick:()=>{o(null),v(null),j(""),N(""),C(""),O(null),P(null),z&&(clearInterval(z),L(null)),R&&(clearInterval(R),U(null)),_&&(clearInterval(_),A(null)),F&&(clearInterval(F),J(null))},disabled:M,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:bg-red-300 whitespace-nowrap",children:"Clear Location"}),$&&(0,f.jsx)("button",{onClick:e=>{e.preventDefault(),G(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 whitespace-nowrap",children:"Refresh"})]})]}),I&&(0,f.jsx)("div",{className:"p-3 rounded "+(n?"bg-red-900 text-red-100":"bg-red-100 text-red-700"),children:I}),$&&(0,f.jsxs)("div",{className:"p-4 rounded "+(n?"bg-blue-900 text-blue-100":"bg-blue-100 text-blue-700"),children:[(0,f.jsx)("div",{className:"flex justify-between items-center mb-3",children:(0,f.jsxs)("div",{className:"font-medium text-lg",children:[$.airline.name," ",$.flight.number]})}),null!==w&&(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("div",{className:"text-sm font-medium mb-1 "+(n?"text-blue-200":"text-blue-800"),children:"Distance to Aircraft"}),(0,f.jsxs)("div",{className:"font-mono text-2xl font-bold",children:[Math.round(w).toLocaleString(),"m"]})]}),(0,f.jsxs)("div",{className:"space-y-3",children:[(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"text-sm font-medium text-center "+(n?"text-blue-200":"text-blue-800"),children:"From"}),(0,f.jsx)("div",{className:"text-base text-center",children:$.departure.airport})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"text-sm font-medium text-center "+(n?"text-blue-200":"text-blue-800"),children:"To"}),(0,f.jsx)("div",{className:"text-base text-center",children:$.arrival.airport})]})]}),$.live&&(0,f.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"text-sm font-medium text-center "+(n?"text-blue-200":"text-blue-800"),children:"Altitude"}),(0,f.jsxs)("div",{className:"text-base text-center",children:[(ee=$.live.altitude,Math.round(3.28084*ee)),"ft"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"text-sm font-medium text-center "+(n?"text-blue-200":"text-blue-800"),children:"Speed"}),(0,f.jsxs)("div",{className:"text-base text-center",children:[(Y=$.live.speed_horizontal,Math.round(.539957*Y)),"kts"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"text-sm font-medium text-center "+(n?"text-blue-200":"text-blue-800"),children:"Direction"}),(0,f.jsxs)("div",{className:"text-base text-center",children:[$.live.direction,"\xb0"]})]}),(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{className:"text-sm font-medium text-center "+(n?"text-blue-200":"text-blue-800"),children:"Status"}),(0,f.jsx)("div",{className:"text-base text-center",children:$.live.is_ground?"On Ground":"In Air"})]})]}),q&&(0,f.jsxs)("div",{className:"text-xs mt-2 text-center "+(n?"text-blue-300":"text-blue-600"),children:["Using API data from ",sessionStorage.getItem("lastApiCall")?new Date(parseInt(sessionStorage.getItem("lastApiCall"))).toLocaleString():"N/A"]})]})]})]}),(0,f.jsx)("div",{className:"h-[600px] rounded border "+(n?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:(0,f.jsxs)(r.W,{style:{height:"100%",width:"100%"},center:l?[l.lat,l.lng]:[51.505,-.09],zoom:l?13:2,scrollWheelZoom:!0,children:[(0,f.jsx)(i.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:n?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),l&&(0,f.jsx)(s.p,{position:[l.lat,l.lng]}),p&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s.p,{position:[p.lat,p.lng],icon:c().divIcon({html:`<div style="transform: rotate(${(null===$||void 0===$||null===(t=$.live)||void 0===t?void 0:t.direction)||0}deg)">\n                      <img src="${u.A}" alt="plane" style="width: 24px; height: 24px;" />\n                    </div>`,className:"",iconSize:[24,24],iconAnchor:[12,12]})},`${p.lat.toFixed(6)}-${p.lng.toFixed(6)}-${(null===$||void 0===$||null===(e=$.live)||void 0===e?void 0:e.direction)||0}-${(null===T||void 0===T?void 0:T.getTime())||0}`),(0,f.jsx)(m,{center:[p.lat,p.lng]})]})]})})]})});var Y,ee}},215:(e,t,n)=>{n.d(t,{Nq:()=>f,Lt:()=>g,X3:()=>h});var a=n(43),l=(n(950),n(772));function r(e){function t(t,n){const{instance:r,context:i}=e(t).current;(0,a.useImperativeHandle)(n,(()=>r));const{children:s}=t;return null==s?null:a.createElement(l.dk,{value:i},s)}return(0,a.forwardRef)(t)}var i=n(576);function s(e,t){const n=(0,a.useRef)(void 0);(0,a.useEffect)((function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}}),[e,t])}var o=n(996);function c(e,t){(0,a.useEffect)((function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}}),[t,e])}function u(e){return function(t){const n=(0,l.U$)(),r=e((0,o.P)(t,n),n);return function(e,t){const n=(0,a.useRef)(t);(0,a.useEffect)((function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t}),[e,t])}(n.map,t.attribution),s(r.current,t.eventHandlers),c(r.current,n),r}}function d(e){return function(t){const n=(0,l.U$)(),r=e((0,o.P)(t,n),n);return s(r.current,t.eventHandlers),c(r.current,n),function(e,t){const n=(0,a.useRef)(void 0);(0,a.useEffect)((function(){if(t.pathOptions!==n.current){const a=t.pathOptions??{};e.instance.setStyle(a),n.current=a}}),[e,t])}(r.current,t),r}}function f(e,t){return r(u((0,i.K)(e,t)))}function g(e,t){return r(d((0,i.K)(e,t)))}function h(e,t){return function(e){function t(t,n){const{instance:l}=e(t).current;return(0,a.useImperativeHandle)(n,(()=>l)),null}return(0,a.forwardRef)(t)}(u((0,i.K)(e,t)))}},419:(e,t,n)=>{n.d(t,{W:()=>s});var a=n(772),l=n(228),r=n(43);function i(e,t){let{bounds:n,boundsOptions:i,center:s,children:o,className:c,id:u,placeholder:d,style:f,whenReady:g,zoom:h,...m}=e;const[p]=(0,r.useState)({className:c,id:u,style:f}),[v,x]=(0,r.useState)(null),b=(0,r.useRef)(void 0);(0,r.useImperativeHandle)(t,(()=>v?.map??null),[v]);const w=(0,r.useCallback)((e=>{if(null!==e&&!b.current){const t=new l.Map(e,m);b.current=t,null!=s&&null!=h?t.setView(s,h):null!=n&&t.fitBounds(n,i),null!=g&&t.whenReady(g),x((0,a.fB)(t))}}),[]);(0,r.useEffect)((()=>()=>{v?.map.remove()}),[v]);const y=v?r.createElement(a.dk,{value:v},o):d??null;return r.createElement("div",{...p,ref:w},y)}const s=(0,r.forwardRef)(i)},515:(e,t,n)=>{n.d(t,{Po:()=>i,ko:()=>r});var a=n(772),l=n(43);function r(){return(0,a.U$)().map}function i(e){const t=r();return(0,l.useEffect)((function(){return t.on(e),function(){t.off(e)}}),[t,e]),t}},576:(e,t,n)=>{n.d(t,{K:()=>r,Q:()=>l});var a=n(43);function l(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function r(e,t){return null==t?function(t,n){const l=(0,a.useRef)(void 0);return l.current||(l.current=e(t,n)),l}:function(n,l){const r=(0,a.useRef)(void 0);r.current||(r.current=e(n,l));const i=(0,a.useRef)(n),{instance:s}=r.current;return(0,a.useEffect)((function(){i.current!==n&&(t(s,n,i.current),i.current=n)}),[s,n,t]),r}}},772:(e,t,n)=>{n.d(t,{U$:()=>o,W4:()=>i,dk:()=>s,fB:()=>r});var a=n(43);const l=1;function r(e){return Object.freeze({__version:l,map:e})}function i(e,t){return Object.freeze({...e,...t})}const s=(0,a.createContext)(null);function o(){const e=(0,a.use)(s);if(null==e)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}},809:(e,t,n)=>{n.d(t,{A:()=>a});n(43);const a=n.p+"static/media/plane-icon.5312c99550d9e701054eea554971757c.svg"},996:(e,t,n)=>{function a(e,t){const n=e.pane??t.pane;return n?{...e,pane:n}:e}n.d(t,{P:()=>a})}}]);
//# sourceMappingURL=216.33689c24.chunk.js.map